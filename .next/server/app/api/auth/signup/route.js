(()=>{var e={};e.id=887,e.ids=[887],e.modules={3295:e=>{"use strict";e.exports=require("next/dist/server/app-render/after-task-async-storage.external.js")},10846:e=>{"use strict";e.exports=require("next/dist/compiled/next-server/app-page.runtime.prod.js")},21254:(e,r,t)=>{"use strict";t.d(r,{CF:()=>c,Er:()=>u,Ey:()=>l,VX:()=>d,th:()=>m});var s=t(80178),a=t(48361),n=t(53943);t(28142);var i=t(42687);let o=new TextEncoder().encode(process.env.JWT_SECRET||"leadcloser-default-secret-key-change-in-production");async function u(e){return await (0,i.hash)(e,10)}async function c(e,r){return await (0,i.verify)(e,r)}async function l(e){return await new s.P({id:e.id,email:e.email,name:e.name,role:e.role}).setProtectedHeader({alg:"HS256"}).setIssuedAt().setExpirationTime("7d").sign(o)}async function p(e){try{let{payload:r}=await (0,a.V)(e,o);return r}catch(e){return null}}function d(e,r){e.cookies.set({name:"auth-token",value:r,httpOnly:!0,secure:!0,sameSite:"strict",maxAge:604800,path:"/"})}async function m(){let e=(0,n.UL)(),r=e.get("auth-token")?.value;return r?await p(r):null}},24467:()=>{},28354:e=>{"use strict";e.exports=require("util")},29294:e=>{"use strict";e.exports=require("next/dist/server/app-render/work-async-storage.external.js")},31418:(e,r,t)=>{"use strict";async function s(e){let{env:r}=process,t=r.DB;try{return await t.prepare("SELECT * FROM users WHERE email = ?").bind(e).first()||null}catch(e){return console.error("Error getting user by email:",e),null}}async function a(e){let{env:r}=process,t=r.DB;try{return await t.prepare("SELECT * FROM users WHERE id = ?").bind(e).first()||null}catch(e){return console.error("Error getting user by ID:",e),null}}async function n(e){let{env:r}=process,t=r.DB,s=crypto.randomUUID(),n=new Date().toISOString();try{await t.prepare("INSERT INTO users (id, email, name, passwordHash, role, createdAt, updatedAt) VALUES (?, ?, ?, ?, ?, ?, ?)").bind(s,e.email,e.name,e.passwordHash,e.role,n,n).run();let r=await a(s);if(!r)throw Error("Failed to create user");return r}catch(e){throw console.error("Error creating user:",e),e}}t.d(r,{ht:()=>s,kg:()=>n})},42687:e=>{"use strict";e.exports=require("@node-rs/bcrypt")},44870:e=>{"use strict";e.exports=require("next/dist/compiled/next-server/app-route.runtime.prod.js")},55511:e=>{"use strict";e.exports=require("crypto")},61419:()=>{},63033:e=>{"use strict";e.exports=require("next/dist/server/app-render/work-unit-async-storage.external.js")},79428:e=>{"use strict";e.exports=require("buffer")},83994:(e,r,t)=>{"use strict";t.r(r),t.d(r,{patchFetch:()=>w,routeModule:()=>m,serverHooks:()=>h,workAsyncStorage:()=>g,workUnitAsyncStorage:()=>y});var s={};t.r(s),t.d(s,{POST:()=>d,dynamic:()=>l,runtime:()=>p});var a=t(43007),n=t(44360),i=t(98343),o=t(28142),u=t(21254),c=t(31418);let l="force-dynamic",p="nodejs";async function d(e){try{let{email:r,password:t,name:s}=await e.json();if(!r||!t||!s)return o.NextResponse.json({success:!1,message:"Name, email, and password are required"},{status:400});if(await (0,c.ht)(r))return o.NextResponse.json({success:!1,message:"Email already in use"},{status:409});let a=await (0,u.Er)(t),n=await (0,c.kg)({email:r,name:s,passwordHash:a,role:"user"}),i=await (0,u.Ey)({id:n.id,email:n.email,name:n.name,role:n.role}),l=o.NextResponse.json({success:!0,message:"Registration successful",user:{id:n.id,email:n.email,name:n.name,role:n.role}});return(0,u.VX)(l,i),l}catch(e){return console.error("Registration error:",e),o.NextResponse.json({success:!1,message:"An error occurred during registration"},{status:500})}}let m=new a.AppRouteRouteModule({definition:{kind:n.RouteKind.APP_ROUTE,page:"/api/auth/signup/route",pathname:"/api/auth/signup",filename:"route",bundlePath:"app/api/auth/signup/route"},resolvedPagePath:"D:\\leadcloser\\leadcloser\\src\\app\\api\\auth\\signup\\route.ts",nextConfigOutput:"",userland:s}),{workAsyncStorage:g,workUnitAsyncStorage:y,serverHooks:h}=m;function w(){return(0,i.patchFetch)({workAsyncStorage:g,workUnitAsyncStorage:y})}}};var r=require("../../../../webpack-runtime.js");r.C(e);var t=e=>r(r.s=e),s=r.X(0,[535,38,956],()=>t(83994));module.exports=s})();